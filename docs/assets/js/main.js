"use strict";const form=document.querySelector(".js_form"),userSearch=document.querySelector(".js_userText"),searchButton=document.querySelector(".js_searchButton"),filmList=document.querySelector(".js_filmList"),favoriteList=document.querySelector(".js_favoriteList"),listTitle=document.querySelector(".js_listTitle"),listFavoriteTitle=document.querySelector(".js_listFavoriteTitle"),listContainer=document.querySelector(".js_favoriteListContainer");let dataFilms=[],favorites=[];function submitDefault(e){e.preventDefault()}function hadleRemoveFavFilm(e){const t=e.target.parentNode,i=parseInt(t.parentNode.id),s=favorites.findIndex(e=>e.show.id===i);favorites.splice(s,1),setInLocalStorage(),paintFavorites()}function hadleRemoveAllFavFilm(){favorites.splice(0,favorites.length),paintFavorites(),paintFilms()}function selectRemoveFavlistener(){const e=document.querySelectorAll(".js_removeFavButton");for(const t of e)t.addEventListener("click",hadleRemoveFavFilm);document.querySelector(".js_removeAllFav").addEventListener("click",hadleRemoveAllFavFilm)}function paintFavorites(){favoriteList.innerHTML="";for(const e of favorites)null===e.show.image?favoriteList.innerHTML+=`<li class="filmfav" id="${e.show.id}"><img class="filmfav__img" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" alt="Caratula"><div class="filmfav__title"><h3> ${e.show.name} </h3><button class="filmfav__button js_removeFavButton">X</button></div></li>`:favoriteList.innerHTML+=`<li class="filmfav" id="${e.show.id}"><img class="filmfav__img" src="${e.show.image.medium}" alt="Caratula"><div class="filmfav__title"><h3>${e.show.name}</h3><button class="filmfav__button js_removeFavButton">X</button></div></li>`;if(""===favoriteList.innerHTML){listFavoriteTitle.innerHTML="";const e=document.querySelector(".js_removeAllFav");null!==e&&e.remove()}else if(listFavoriteTitle.innerHTML="Series favoritas",null===document.querySelector(".js_removeAllFav")){const e=document.createElement("button"),t=document.createTextNode("Borrar favoritos");e.appendChild(t),e.classList.add("list__button","js_removeAllFav"),listContainer.appendChild(e)}selectRemoveFavlistener()}function handleFilmSelected(e){const t=parseInt(e.currentTarget.id),i=dataFilms.find(e=>e.show.id===t),s=favorites.findIndex(e=>e.show.id===t);-1===s?favorites.push(i):favorites.splice(s,1),paintFavorites(e),paintFilms(),setInLocalStorage()}function selectedFilmListener(){const e=document.querySelectorAll(".js_film");for(const t of e)t.addEventListener("click",handleFilmSelected)}function isInFavorite(e){return void 0!==favorites.find(t=>t.show.id===e.show.id)}function paintFilms(){filmList.innerHTML="";let e="";for(const t of dataFilms){e=isInFavorite(t)?"film__selected":"",null===t.show.image?filmList.innerHTML+=`<li class="film js_film ${e}" id="${t.show.id}"><img src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" alt="Caratula"><h3 class="film__title">${t.show.name}</h3></li>`:filmList.innerHTML+=`<li class="film js_film ${e}" id="${t.show.id}"><img src="${t.show.image.medium}" alt="Caratula"><h3 class="film__title">${t.show.name}</h3></li>`,listTitle.innerHTML="Series",selectedFilmListener()}}function setInLocalStorage(){const e=JSON.stringify(favorites);localStorage.setItem("favoritesFilms",e)}function getApi(){const e=userSearch.value;fetch("//api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{dataFilms=e,paintFilms()})}function getLocalStorage(){const e=localStorage.getItem("favoritesFilms");if(null===e)getApi();else{const t=JSON.parse(e);favorites=t,paintFavorites()}}function handleClickButton(){getApi()}form.addEventListener("submit",submitDefault),searchButton.addEventListener("click",handleClickButton),getLocalStorage();