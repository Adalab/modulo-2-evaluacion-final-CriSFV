"use strict";const form=document.querySelector(".js_form"),userSearch=document.querySelector(".js_userText"),searchButton=document.querySelector(".js_searchButton"),filmList=document.querySelector(".js_filmList"),favoriteList=document.querySelector(".js_favoriteList");let dataFilms=[],favorites=[];function submitDefault(t){t.preventDefault()}function paintFavorites(){favoriteList.innerHTML="";for(const t of favorites)null===t.show.image?favoriteList.innerHTML+=`<li class="film js_film" id="${t.show.id}"><img src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" alt="Caratula"><h3 class="film__title">${t.show.name}</h3></li>`:favoriteList.innerHTML+=`<li class="film js_film" id="${t.show.id}"><img src="${t.show.image.medium}" alt="Caratula"><h3 class="film__title">${t.show.name}</h3></li>`}function handleFilmSelected(t){const e=parseInt(t.target.parentElement.id),i=dataFilms.find(t=>t.show.id===e),s=favorites.findIndex(t=>t.show.id===e);-1===s?favorites.push(i):favorites.splice(s,1),paintFavorites(t),paintFilms(),setInLocalStorage()}function selectedFilmListener(){const t=document.querySelectorAll(".js_film");for(const e of t)e.addEventListener("click",handleFilmSelected)}function isInFavorite(t){return void 0!==favorites.find(e=>e.show.id===t.show.id)}function paintFilms(){filmList.innerHTML="";let t="";for(const e of dataFilms){t=isInFavorite(e)?"film__selected":"",null===e.show.image?filmList.innerHTML+=`<li class="film js_film ${t}" id="${e.show.id}"><img src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" alt="Caratula"><h3 class="film__title">${e.show.name}</h3></li>`:filmList.innerHTML+=`<li class="film js_film ${t}" id="${e.show.id}"><img src="${e.show.image.medium}" alt="Caratula"><h3 class="film__title">${e.show.name}</h3></li>`,selectedFilmListener()}}function setInLocalStorage(){const t=JSON.stringify(dataFilms),e=JSON.stringify(favorites);localStorage.setItem("films",t),localStorage.setItem("favoritesFilms",e)}function getApi(){const t=userSearch.value;fetch("//api.tvmaze.com/search/shows?q="+t).then(t=>t.json()).then(t=>{dataFilms=t,paintFilms(),setInLocalStorage()})}function getLocalStorage(){const t=localStorage.getItem("films"),e=localStorage.getItem("favoritesFilms");if(null===t||null===e)getApi();else{const i=JSON.parse(e),s=JSON.parse(t);favorites=i,dataFilms=s,paintFilms(),paintFavorites()}}function handleClickButton(){getApi()}form.addEventListener("submit",submitDefault),searchButton.addEventListener("click",handleClickButton),getLocalStorage();